# 스토어·플랫폼 관리 가이드

셀러헬퍼에서 플랫폼과 스토어를 어떻게 관리하고 사용하는지 설명합니다.

---

## 1. 핵심 원칙

| 역할 | 하는 일 | 하지 않는 일 |
|------|----------|--------------|
| **운영자** | DB에 **플랫폼(Mall)** 등록 (쿠팡, 스마트스토어, 카카오쇼핑 등) | 스토어 등록 ❌, API 키 입력 ❌ |
| **셀러** | 등록된 플랫폼 **선택** → 스토어명·API 입력 → **연동** | 스토어 신청 ❌ |

- **신청 프로세스 없음** – 운영자가 플랫폼 풀만 등록하면, 셀러는 그중에서 선택·API 입력·연동만 하면 됩니다.
- **운영자 = 플랫폼 풀 정의**, **셀러 = 스토어 생성·API 연동 담당**

---

## 2. 개념 정리

### 2.1 플랫폼 vs 스토어

| 구분 | 설명 | 예시 |
|------|------|------|
| **플랫폼 (Mall)** | 쇼핑몰 종류. 시스템관리 > **플랫폼 관리**에서 DB에 등록 | 쿠팡, 스마트스토어, 11번가, 카카오쇼핑, G마켓, 옥션 |
| **스토어 (Store)** | 셀러가 플랫폼 선택 후 실제로 연동한 계정 1개 | 홍길동 쿠팡, 김철수 스마트스토어 |

- **플랫폼** = Mall 테이블. 운영자만 추가·수정·삭제.
- **스토어** = Store 테이블. 셀러가 플랫폼 선택 후 연동 시 생성.

### 2.2 두 가지 메뉴

| 메뉴 | 경로 | 대상 | 역할 |
|------|------|------|------|
| **플랫폼 관리** | 시스템관리 > **플랫폼 관리** (`/system/platform`) | 운영자 | Mall **등록·수정·삭제** (코드, 이름, 사용 여부) |
| **스토어 연동** | 환경설정 > 스토어 설정 > **스토어 연동** (`/settings/store/list`) | 셀러 | 플랫폼 **선택** → 스토어명·API 입력 → **연동** |

---

## 3. 전체 흐름

```
[운영자] 시스템관리 > 플랫폼 관리
    → 플랫폼 추가 (코드: COUPANG, NAVER, 11ST, KAKAO 등)
    → 플랫폼명: 쿠팡, 스마트스토어, 11번가, 카카오쇼핑
    → 사용 여부: 사용/미사용
    → ⚠️ API 키는 입력하지 않음

[셀러] 환경설정 > 스토어 연동
    → 사용 가능한 플랫폼 목록 조회 (운영자가 등록한 것만)
    → 플랫폼 선택
    → 스토어명·API Key·API Secret 입력
    → 연동 → Store + StoreAuth 생성
```

---

## 4. 플랫폼 관리 (운영자)

**경로:** 시스템관리 > 플랫폼 관리 (`/system/platform`)

### 4.1 하는 일

- 플랫폼 **추가·수정·삭제**
- **플랫폼 코드** (COUPANG, NAVER, 11ST, KAKAO, GMARKET, AUCTION)
- **플랫폼명** (쿠팡, 스마트스토어, 11번가 등)
- **사용 여부**: 사용 시에만 셀러 스토어 연동 화면에 표시

### 4.2 플랫폼 추가 시 입력 항목

| 항목 | 필수 | 설명 |
|------|------|------|
| 플랫폼 코드 | ✅ | 영문 대문자 (COUPANG, NAVER, 11ST, KAKAO 등). productStoreTabs 매핑용 |
| 플랫폼명 | ✅ | 표시명 (쿠팡, 스마트스토어, 11번가 등) |
| 채널 | - | 예: 이베이코리아, 네이버 |
| API 베이스 URL | - | 해당 플랫폼 API 엔드포인트 (선택) |
| 사용 여부 | - | 사용 시 셀러가 선택 가능 |

### 4.3 운영자가 하지 않는 것

- **API 키 입력** – 셀러가 스토어 연동 화면에서 직접 입력합니다.

---

## 5. 스토어 연동 (셀러)

**경로:** 환경설정 > 스토어 설정 > 스토어 연동 (`/settings/store/list`)

### 5.1 하는 일

- 운영자가 등록한 **플랫폼 목록** 조회 (사용 여부가 사용인 것만)
- **플랫폼 선택** → **스토어명·API Key·API Secret** 입력
- **연동** → Store + StoreAuth 생성
- 연동 해제

### 5.2 연동 절차

1. 운영자가 **플랫폼 관리**에서 플랫폼을 등록 (쿠팡, 스마트스토어 등)
2. 셀러가 **스토어 연동** 화면 접속 → "스토어 연동 추가" 클릭
3. **플랫폼 선택** → **스토어명** 입력 → **API Key·Secret** 입력
4. 연동 완료 후 주문·상품·배송 등 기능 사용

---

## 6. 데이터 구조 (Mall / Store / StoreAuth)

### 6.1 엔티티 관계

```
Mall (플랫폼) ← 운영자가 등록
  └── Store (스토어) ← 셀러가 플랫폼 선택 후 연동 시 생성
        ├── Company (셀러 회사)
        └── StoreAuth (API 키, 시크릿) ← 연동 시 함께 생성
```

### 6.2 주요 테이블

| 테이블 | 설명 |
|--------|------|
| `malls` | 플랫폼 (code, name, channel, enabled). 운영자만 CRUD |
| `companies` | 회사 (셀러 소속) |
| `stores` | 스토어 (mall_uid, company_uid, name). 셀러가 연동 시 생성 |
| `store_auths` | API 인증 정보 (store_uid, api_key, api_secret) |

---

## 7. 권한

| 메뉴 키 | 접근 대상 |
|--------|-----------|
| `settings-store-list` | 스토어 연동 (환경설정) |
| `system-platform` | 플랫폼 관리 (시스템관리) |

운영자 권한에는 `system-platform`이 포함되며, 일반 셀러에게는 `settings-store-list`만 부여됩니다.

---

## 8. DB 초기화

플랫폼·회사 초기 데이터는 애플리케이션 시작 시 자동 생성됩니다.

- **MallInitializer**: COUPANG, NAVER, 11ST, KAKAO, GMARKET, AUCTION
- **CompanyInitializer**: 테스트회사 1개
